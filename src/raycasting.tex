P=O+tD\\
||P-P_0||=r\\
\\
(P-P_0)\cdot(P-P_0)=r^2\\
(O+tD-P_0)\cdot(O+tD-P_0)=r^2\\
\\
L=O-P_0\\
(L+tD)\cdot(L+tD)=r^2\\
\\
M=L+tD\\
M\cdot(L+tD)=r^2\\
M\cdot L+M\cdot tD=r^2\\
(L+tD)\cdot L+(L+tD)\cdot tD=r^2\\
L\cdot L+t(L \cdot D) +t(L \cdot D)+t^2(D\cdot D)=r^2\\
L\cdot L+2t(L \cdot D)+t^2(D\cdot D)=r^2\\
(O-P_0)\cdot (O-P_0)+2t((O-P_0) \cdot D)+t^2(D\cdot D)=r^2\\
(D\cdot D)t^2+2D\cdot (O-P_0)t+(O-P_0)\cdot (O-P_0)-r^2=0\\
\\
at^2+bt+c=0\\
\\
a = D\cdot D\\
b = 2D\cdot (O-P_0)\\
c = (O-P_0)\cdot (O-P_0)-r^2\\
\\
t=\frac{-b\pm\sqrt{b^2-4ac}}{2a}



u=\frac
{
det
\begin{bmatrix}
(O_x-A_x)& E_{2x} & -D_x\\
(O_y-A_y) & E_{2y} & -D_y\\
(O_z-A_z) & E_{2z} & -D_z\\
\end{bmatrix}
}
{
det
\begin{bmatrix}
E_{1x} & E_{2x} & -D_x\\
E_{1y} & E_{2y} & -D_y\\
E_{1z} & E_{2z} & -D_z\\
\end{bmatrix}
}
\\
\\
v=\frac
{
det
\begin{bmatrix}
E_{1x} & (O_x-A_x) & -D_x\\
E_{1y} & (O_y-A_y)  & -D_y\\
E_{1z} & (O_z-A_z) & -D_z\\
\end{bmatrix}
}
{
det
\begin{bmatrix}
E_{1x} & E_{2x} & -D_x\\
E_{1y} & E_{2y} & -D_y\\
E_{1z} & E_{2z} & -D_z\\
\end{bmatrix}
}
\\
\\
t=\frac
{
det
\begin{bmatrix}
E_{1x} & E_{2x} & (O_x-A_x)\\
E_{1y} & E_{2y} & (O_y-A_y)\\
E_{1z} & E_{2z} & (O_z-A_z)\\
\end{bmatrix}
}
{
det
\begin{bmatrix}
E_{1x} & E_{2x} & -D_x\\
E_{1y} & E_{2y} & -D_y\\
E_{1z} & E_{2z} & -D_z\\
\end{bmatrix}
}

u=\frac
{
det
\begin{bmatrix}
(O-A)& E_{2} & -D\\
\end{bmatrix}
}
{
det
\begin{bmatrix}
E_{1} & E_{2} & -D\\
\end{bmatrix}
}
\\
\\
v=\frac
{
det
\begin{bmatrix}
E_{1} & (O-A) & -D\\
\end{bmatrix}
}
{
det
\begin{bmatrix}
E_{1} & E_{2} & -D\\
\end{bmatrix}
}
\\
\\
t=\frac
{
det
\begin{bmatrix}
E_{1} & E_{2} & (O-A)\\
\end{bmatrix}
}
{
det
\begin{bmatrix}
E_{1} & E_{2} & -D\\
\end{bmatrix}
}

T=O-A\\
det\begin{bmatrix}
T&E_2&-D\\
\end{bmatrix}
=
T\cdot (D\times E_2)\\
det\begin{bmatrix}
E_1&T&-D\\
\end{bmatrix}
=
E_1\cdot (D\times T)\\
det\begin{bmatrix}
E_1&E_2&T\\
\end{bmatrix}
=
E_1\cdot(E_2\times T)